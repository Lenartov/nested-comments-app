<table class="comments-table">
 <thead>
    <tr>
      <th (click)="sort('userName')">
        User Name
        <span *ngIf="sortField === 'userName'">
          <span *ngIf="sortDirection === 'asc'">&#9650;</span>  <!-- стрілочка вгору -->
          <span *ngIf="sortDirection === 'desc'">&#9660;</span> <!-- стрілочка вниз -->
        </span>
      </th>
      <th (click)="sort('email')">
        Email
        <span *ngIf="sortField === 'email'">
          <span *ngIf="sortDirection === 'asc'">&#9650;</span>
          <span *ngIf="sortDirection === 'desc'">&#9660;</span>
        </span>
      </th>
      <th (click)="sort('createdAt')">
        Created At
        <span *ngIf="sortField === 'createdAt'">
          <span *ngIf="sortDirection === 'asc'">&#9650;</span>
          <span *ngIf="sortDirection === 'desc'">&#9660;</span>
        </span>
      </th>
      <th>Message</th>
      <th>Replies</th>
    </tr>
  </thead>
  <tbody>
    <ng-container *ngFor="let comment of comments">
      <tr>
        <td>{{ comment.userName }}</td>
        <td>{{ comment.email }}</td>
        <td>{{ comment.message }}</td>
        <td>{{ comment.createdAt | date:'short' }}</td>
        <td>
          <button *ngIf="comment.hasReplies" (click)="toggleReplies(comment)">
            {{ isExpanded(comment) ? 'Hide Replies' : 'Show Replies' }} ({{ comment.hasReplies }})
          </button>
        </td>
      </tr>

      <!-- Відповіді, якщо коментар розгорнутий -->
      <tr *ngIf="isExpanded(comment)" class="replies-row">
        <td colspan="5">
          <app-comment-list 
            [comments]="commentRepliesMap[comment.id]" 
            *ngIf="commentRepliesMap[comment.id]?.length; else noReplies">
          </app-comment-list>

          <ng-template #noReplies>
            <div>No replies found.</div>
          </ng-template>
        </td>
      </tr>
    </ng-container>
  </tbody>
</table>
